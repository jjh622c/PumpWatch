# PumpWatch v2.0 System Configuration

# Server settings
server:
  host: "localhost"
  port: 8080
  timeout: "30s"

# Upbit monitoring settings
upbit:
  enabled: true
  api_url: "https://api-manager.upbit.com/api/v1/announcements?os=web&page=1&per_page=20&category=trade"
  poll_interval: "5s"
  timeout: "10s"
  user_agent: "PumpWatch-v2.0"

# Exchange WebSocket configurations
exchanges:
  binance:
    enabled: true
    spot_endpoint: "wss://stream.binance.com:9443/ws"
    futures_endpoint: "wss://fstream.binance.com/ws"
    max_symbols_per_connection: 100
    retry_cooldown: "5s"
    max_retries: 10
    connection_timeout: "30s"
    read_timeout: "30s" 
    write_timeout: "10s"
  
  bybit:
    enabled: true
    spot_endpoint: "wss://stream.bybit.com/v5/public/spot"
    futures_endpoint: "wss://stream.bybit.com/v5/public/linear"
    max_symbols_per_connection: 50
    retry_cooldown: "5s"
    max_retries: 10
    connection_timeout: "30s"
    read_timeout: "30s"
    write_timeout: "10s"
    
  kucoin:
    enabled: true
    spot_endpoint: "wss://ws-api.kucoin.com/endpoint"
    futures_endpoint: "wss://ws-api-futures.kucoin.com/endpoint"
    max_symbols_per_connection: 100
    retry_cooldown: "5s"
    max_retries: 10
    connection_timeout: "30s"
    read_timeout: "30s"
    write_timeout: "10s"
    
  okx:
    enabled: true
    spot_endpoint: "wss://ws.okx.com:8443/ws/v5/public"
    futures_endpoint: "wss://ws.okx.com:8443/ws/v5/public"
    max_symbols_per_connection: 100
    retry_cooldown: "5s"
    max_retries: 10
    connection_timeout: "30s"
    read_timeout: "30s"
    write_timeout: "10s"
    
  gate:
    enabled: true
    spot_endpoint: "wss://api.gateio.ws/ws/v4/"
    futures_endpoint: "wss://fx-ws.gateio.ws/v4/ws/usdt"
    max_symbols_per_connection: 100
    retry_cooldown: "5s"
    max_retries: 10
    connection_timeout: "30s"
    read_timeout: "30s"
    write_timeout: "10s"
    
  phemex:
    enabled: true
    spot_endpoint: "wss://ws.phemex.com"
    futures_endpoint: "wss://ws.phemex.com"
    max_symbols_per_connection: 20
    retry_cooldown: "5s"
    max_retries: 10
    connection_timeout: "30s"
    read_timeout: "30s"
    write_timeout: "10s"

# Storage settings
storage:
  enabled: true
  data_dir: "./data"
  raw_data_enabled: true
  refined_enabled: true
  compression: false
  retention_days: 30
  max_file_size: "100MB"
  backup_enabled: true
  backup_interval: "24h"

# Analysis settings
analysis:
  enabled: true                    # Enable/disable pump analysis (성능 고려시 false로 설정)
  threshold_percent: 3.0           # 3% price increase threshold
  time_window: "1s"                # 1-second analysis windows
  min_volume_ratio: 2.0            # Minimum volume increase
  max_analysis_delay: "2s"         # Delay before analysis

# Collection timing settings
collection:
  pre_trigger_duration: "20s"    # Data collection start before listing announcement
  collection_duration: "20s"     # Total collection duration after trigger
  post_analysis_delay: "2s"      # Delay before running analysis

# System timing settings
system:
  shutdown_timeout: "30s"        # Graceful shutdown timeout
  status_report_interval: "60s"  # System status reporting interval
  auto_save_interval: "5m"       # Auto-save configuration interval
  pool_startup_delay: "500ms"    # Delay between worker pool startups

# Connection timing settings (fallbacks for exchanges without specific config)
connection:
  default_ping_interval: "25s"
  default_connection_timeout: "30s"
  default_retry_delay: "1s"
  batch_processing_delay: "500ms"  # Delay between subscription batches
  api_rate_limit_delay: "100ms"    # General API rate limiting delay

# 🚀 QuestDB 고성능 데이터베이스 설정 (Phase 2-5 완전 구현)
questdb:
  # Phase 3: 하이브리드 모드 활성화 (안전한 점진적 전환)
  enabled: true
  host: "localhost"
  port: 8812
  database: "qdb"
  user: "admin"
  password: "quest"

  # Phase 2 문서 사양대로 고성능 배치 처리 설정
  batch_size: 1000                # 문서 사양: 1000개씩 배치 처리
  flush_interval: "1s"            # 문서 사양: 1초마다 플러시
  buffer_size: 50000              # 문서 사양: 50,000개 버퍼
  worker_count: 4                 # 문서 사양: 4개 워커로 병렬 처리

  # 연결 풀 최적화
  max_open_conns: 20
  max_idle_conns: 10
  conn_max_lifetime: "30m"

  # 재시도 및 안정성
  max_retries: 3
  base_delay: "100ms"
  max_delay: "5s"
  backoff_factor: 2.0

  # 🔄 Phase 3-5: 점진적 전환 설정 (하이브리드 모드)
  hybrid_mode: true               # 기존 시스템과 병렬 운영
  compare_results: false          # 결과 비교 (개발용, 성능에 영향)
  migration_phase: 1              # 1: 10% QuestDB, 2: 50%, 3: 100%, 4: 완전 전환
